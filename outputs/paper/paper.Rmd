---
title: "Battling Climate Change: Implications on the Canadian Climate Policies in Recent Years"
author: 
  - Owen Huang
thanks: "Code and data are available at: https://github.com/Ovven999/Climate_Change "
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "In this paper, we have fitted a model to predict the anuual national greenhouse gas emission in Canada, and evaluated against the target of 30% reduction in emissions below the 2005 levels by 2030. With the current data presented, we have high believes that Canada will successfully reach its goal by the year of 2030. This is an important implication as it indicates that it is highly likely that Canada will be able to fulfill its goal as stated in the Paris Agreement. Fulfilling the Paris Agreement is the first step toward mitigating the devastating effects of climate change and providing the future generation with a safe world to live in, not a corrupted one."
output:
  bookdown::pdf_document2
toc: TRUE
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(dplyr)
library(ggplot2)
library(knitr)
library(kableExtra)
library(ggpubr)
library(ggrepel)
library(haven)
library("readxl")
library(readr)
library(lme4)
```

\newpage

# Introduction

Our planet is burning. Greenhouse gases are the by-products of energy creation, which humanity will only produce more as we demand more energy for transportation, manufacturing goods, building infrastructures, and much more. Burning fossil fuels such as oil, coal, and natural gas is the primary method for creating energy which makes up approximately 85% of the world's total energy output. The consequence of burning fossil fuels to create energy is the release of greenhouse gases into the atmosphere such as carbon dioxide, sulfur, methane, etc. Greenhouse gases are good at trapping heat within the planet and capturing and retaining heat that radiates from outer space. Thus, a reasonable amount of greenhouse gas emissions will not have a large effect on the Earth's climate, but make the planet more desirable for lives. However, over the past decades of greenhouse gas accumulation, the greenhouse gases that are released into our atmosphere is increasing at an accelerating speed since the industrial revolution. With an increasing amount of greenhouse gases we are pouring into the atmosphere, too much heat is trapped between the Earth's crust and the atmosphere, resulting in the rise of global temperature and it will make the planet warmer and warmer each year we step into the future. Such phenomenon is known as global warming, and its devastating effects are becoming more apparent in recent years. Icecap melting, sea level rising, regional droughts, and the possible sixth mass extinction are all direct and indirectly related to the rising global temperature.

Realizing this issue, 196 countries had come together in 2015 and signed the Paris Agreement to reduce greenhouse gas emissions and fight climate change. Countries need to seek ways to reduce the amount of greenhouse gas emissions, as well as reduce the number of greenhouse gases in the atmosphere before we reach a point of no turning back. The goal of Canada was to reduce GHG emissions by 30% below 2005 levels by 2030. As a result Greenhouse, Gas Pollution Pricing Act (GGPPA) was introduced in 2018 which targets pricing carbon pollution, climate resilience, and clean innovation, technology, and jobs. 

This paper sets out to investigate the effectiveness of the actions performed against climate change. We are interested to find out which components of the economical activities are contributing the most to greenhouse gas emissions. In doing so, we are able to pinpoint the potential sectors of the economy that the policies makers and impose policies on to reduce the overall greenhouse gas emissions. We will also briefly discuss government interventions such as carbon pricing, promoting zero-emission vehicles, and energy efficiency retrofits for buildings. We are interested to know, according to the current performance of the government policies, is Canada able to obtain the goal of reducing greenhouse gas emissions by 30% below the 2005 levels. 

The most recent data on Canada's greenhouse gas emissions ended in 2019 before the COVID-19 pandemic struck. As a result, we have also taken into account the potential effects of the pandemic in the **Discussion** section, and we determined it would decrease the greenhouse gas emissions in the short-run and will have an overall positive effect upon reaching the final target. The Pan-Canadian Framework on Clean Growth and Climate Change took place in 2018, but soon after its settlement, it is interapted by the pandemic in late 2019. Since we do not have access to the total greenhouse gas emissions in Canada after 2020, we hypothesize and fitted a generalized linear mixed model greenhouse gas emissions against various factors such as various components of GDP, population, and year to figure out which economic activities are the primary driving force of greenhouse gas emissions.

After we obtained the result, we conclude that with the evidence we are presented with, we have strong evidence supporting the hypothesis that by the year 2030, the greenhouse gas emission level will be below that of 2005. This is an important implication as it indicates that it is highly likely that Canada will be able to fulfill its goal as stated in the Paris Agreement. Fulfilling the Paris Agreement is the first step toward mitigating the devastating effects of climate change and providing the future generation with a safe world to live in, not a corrupted one. 

In **Data** section, we will give detailed information on the data set we will use in this analysis, including their sources and the variables that we are interested in. We will also perform an Exploratory Data Analysis (EDA) to determine the nature of the data set to verify the assumptions that we need to fit an appropriate model. In **Result** section we will present the resulting figures and models and discuss their implications on the research question. In **Model** section under results, we will explain the statistical method we will use to answer our research question, along with the general implications and application.Lastly, in the **Discussion** section, we will elaborate on our results in the real world settings and explain what the results we obtained from the analysis tell us about the future greenhouse gas emission levels, the economic implications, and the takeaway for the reader of this paper.



# Data
```{r, echo=FALSE, include=FALSE, warning=FALSE}
# Read in the raw data. 

# national carbon emissions https://www.icos-cp.eu/science-and-impact/global-carbon-budget/2021
National_Territorial_Emissions <- read_excel("../../inputs/data/National_Carbon_Emissions_2021v1.0.xlsx", 
                                                 sheet = "Territorial Emissions")
National_Territorial_Emissions <- National_Territorial_Emissions[11:73,]
colnames(National_Territorial_Emissions) <- National_Territorial_Emissions[1,]
colnames(National_Territorial_Emissions)[1] <- "Year"
National_Territorial_Emissions <- National_Territorial_Emissions[-1, ] 
Country_Emissions <- National_Territorial_Emissions %>% select(Year, Australia, Brazil, Canada, China, Cuba, France, Germany, India, Japan, Mexico, Sweden, USA)


Country_Emissions <- mutate_all(Country_Emissions, function(x) as.numeric(as.character(x)))
Country_Emissions <- Country_Emissions %>% 
  pivot_longer(colnames(Country_Emissions)[2:13], names_to = "country", values_to = "GHG Emission")

rm(National_Territorial_Emissions)

# canada ghg emission https://www.canada.ca/en/environment-climate-change/services/environmental-indicators/greenhouse-gas-emissions.html#agriculture
canada_ghg_emission <- read_csv("../../inputs/data/canada_ghg_emission.csv")
canada_ghg_emission <- canada_ghg_emission[2:33,]
colnames(canada_ghg_emission) <- canada_ghg_emission[1,]
canada_ghg_emission <- canada_ghg_emission[-1, ] 
canada_ghg_emission <- mutate_all(canada_ghg_emission, function(x) as.numeric(as.character(x)))

# canada gdp per capita https://data.worldbank.org/indicator/NY.GDP.PCAP.CD?locations=CA
CAD_GDP_per_cap <- read_excel("../../inputs/data/GDP_per_cap.xls")
CAD_GDP_per_cap <- CAD_GDP_per_cap[3:269,]
colnames(CAD_GDP_per_cap) <- CAD_GDP_per_cap[1,]
CAD_GDP_per_cap <- CAD_GDP_per_cap[-1, ] 
CAD_GDP_per_cap <- CAD_GDP_per_cap %>% filter(`Country Name` == "Canada")
temp <- CAD_GDP_per_cap %>% 
  pivot_longer(colnames(CAD_GDP_per_cap), names_to = "Year", values_to = "GDP per Capita")
temp <- temp[5:65,]
CAD_GDP_per_cap <- temp
rm(temp)

# ghg_emission by province https://www.canada.ca/en/environment-climate-change/services/environmental-indicators/greenhouse-gas-emissions.html#agriculture
prov_ghg_emissions <- read_csv("../../inputs/data/ghg-emissions-regional-en.csv", 
                                      skip = 1)
prov_ghg_emissions <- prov_ghg_emissions[1:14,]
colnames(prov_ghg_emissions) <- prov_ghg_emissions[1,]
prov_ghg_emissions <- prov_ghg_emissions[-1, ] 
prov_ghg_emissions  <- prov_ghg_emissions %>% 
  pivot_longer(colnames(prov_ghg_emissions)[2:4], names_to = "Year", values_to = "GHG Emission") %>%
  mutate(`Province or territory` = case_when(`Province or territory` == "Newfoundland and Labrador (NL)"~"NL",
                                             `Province or territory` == "Prince Edward Island (PE)"~"PE",
                                             `Province or territory` == "Nova Scotia (NS)"~"NS",
                                             `Province or territory` == "New Brunswick (NB)"~"NB",
                                             `Province or territory` == "Quebec (QC)"~"QC",
                                             `Province or territory` == "Manitoba (MB)"~"MB",
                                             `Province or territory` == "Saskatchewan (SK)"~"SK",
                                             `Province or territory` == "Alberta (AB)"~"AB",
                                             `Province or territory` == "British Columbia (BC)"~"BC",
                                             `Province or territory` == "Yukon (YT)"~"YT",
                                             `Province or territory` == "Northwest Territories (NT)"~"NT",
                                             `Province or territory` == "Nunavut (NU)[A]"~"NU",
                                             `Province or territory` == "Ontario (ON)"~"ON")) %>%
  mutate(Year = case_when(Year == "1990 greenhouse gas emissions (megatonnes of carbon dioxide equivalent)"~"1990 GHG emission",
                          Year == "2005 greenhouse gas emissions (megatonnes of carbon dioxide equivalent)"~"2005 GHG emission",
                          Year == "2020 greenhouse gas emissions (megatonnes of carbon dioxide equivalent)"~"2020 GHG emission"))
prov_ghg_emissions$`GHG Emission` <- as.numeric(prov_ghg_emissions$`GHG Emission`)

# ghg emission by sectors https://www.canada.ca/en/environment-climate-change/services/environmental-indicators/greenhouse-gas-emissions.html#agriculture
sector_ghg_emissions <- read_csv("../../inputs/data/ghg-emissions-sector-en.csv", 
                                    skip = 1)
sector_ghg_emissions <- sector_ghg_emissions[1:32,]
colnames(sector_ghg_emissions) <- sector_ghg_emissions[1,]
sector_ghg_emissions <- sector_ghg_emissions[-1, ] 
colnames(sector_ghg_emissions) <- c("Year", "Oil and gas", "Transport", "Buildings", "Electricity", "Heavy industry", "Agriculture", "Waste and others")
sector_ghg_emissions <- mutate_all(sector_ghg_emissions, function(x) as.numeric(as.character(x)))
sector_ghg_emissions <- sector_ghg_emissions %>% mutate(Total = `Oil and gas` + Transport + Buildings + Electricity + `Heavy industry` + Agriculture + `Waste and others`)
temp <- sector_ghg_emissions %>% 
  pivot_longer(colnames(sector_ghg_emissions)[2:8], names_to = "sector", values_to = "Megatonnes of carbon dioxide equivalent")
sector_ghg_emissions <- temp
rm(temp)

# canada population https://data.worldbank.org/indicator/SP.POP.TOTL?locations=CA
CAD_pop <- read_excel("../../inputs/data/pop.xls")
CAD_pop <- CAD_pop[3:269,]
colnames(CAD_pop) <- CAD_pop[1,]
CAD_pop <- CAD_pop[-1, ] 
CAD_pop <- CAD_pop %>% filter(`Country Name` == "Canada")
temp <- CAD_pop %>% 
  pivot_longer(colnames(CAD_pop), names_to = "Year", values_to = "pop")
temp <- temp[5:65,]
CAD_pop <- temp
rm(temp)

# join gdp and pop
canada_data <- left_join(CAD_GDP_per_cap, CAD_pop)
canada_data <- mutate_all(canada_data, function(x) as.numeric(as.character(x)))
canada_data <- canada_data %>% mutate(GDP = `GDP per Capita`*pop) %>% filter(Year >= 1990)
rm(CAD_GDP_per_cap, CAD_pop)

canada_data <- right_join(canada_data, canada_ghg_emission)
rm(canada_ghg_emission)

# canada gdp by expenditure https://www150.statcan.gc.ca/t1/tbl1/en/tv.action?pid=3610022201
gdp_expenditure <- read_csv("../../inputs/data/gdp_ex.csv")
gdp_expenditure <- gdp_expenditure %>% select(REF_DATE, Estimates, VALUE)


gdp_exp <- read_csv("../../inputs/data/gdp_exp.csv", col_names = FALSE)
gdp_exp <- t(gdp_exp)
colnames(gdp_exp) <- gdp_exp[1,]
colnames(gdp_exp)[1] <- "Year"
gdp_exp <- gdp_exp[-1, ] 
gdp_exp <- as.data.frame(gdp_exp)
temp <- gdp_exp %>% select(Year, 
                           "Final consumption expenditure", 
                           "Household final consumption expenditure", 
                           "Goods", "Durable goods", 
                           "Semi-durable goods",
                           "Non-durable goods",
                           "Services",                                                                                                                                        
                           "Non-profit institutions serving households' final consumption expenditure",
                           "General governments final consumption expenditure",
                           "Gross fixed capital formation",
                           "Business gross fixed capital formation",
                           "Residential structures",
                           "Non-residential structures, machinery and equipment",
                           "Non-residential structures",
                           "Machinery and equipment",
                           "Intellectual property products",
                           "Non-profit institutions serving households' gross fixed capital formation",
                           "General governments gross fixed capital formation",
                           "Investment in inventories",
                           "Of which: business investment in inventories",
                           "Non-farm",
                           "Farm",
                           "Exports to other countries",
                           "Imports from other countries",
                           "Gross domestic product at market prices",
                           "Final domestic demand")
temp <- mutate_all(temp, function(x) as.numeric(gsub(",", "", x)))
temp <- left_join(canada_data, temp)
canada_data <- temp
rm(temp)
rm(gdp_exp)

```

Throguhout the analysis of this report, we used $R$ (@1), the $tidyverse$ (@2) package, the $kableExtra$ (@3) package, the $usmap$ (@4) package, the $ggplot2$ (@5) package,the $ggpubr$ (@6) package, and the $readxl$ (@7) package for the data analyzing process and graph plotting. All data and graphs are inspired by Melissa S. Kearney, Phillip B. Levine, and Luke Pardue. 

The data we have collected are from 3 major sources. First, we obtained the nation-wise greenhouse gas emissions from the Integrated Carbon Observation System (ICOS). ICOS provides standardized open data about various climate measurements. It is consisted of over 140 measurement stations worldwide, and working with numerous scientist and universities around the globe to provide the most accurate data and analysis on our climate (@8). Below is a table describing variables in from data we collected from ICOS after cleaning.

```{r, echo=FALSE, }
canada_data %>% summarise(Variable = c("Year", "Country", "GHG Emissions"),
                          Descriptions = c("Years from 1959 to 2020", 
                                           "Countries containing Australia, Brazil, Canada, USA, China, etc.(total of 12 countries)", 
                                           "the greenhouse gas emissions in million tonnes per year"))%>%
  kable(caption = "GHG Emissions, by country")%>%
  kable_styling(latex_options = "HOLD_position")%>%
  add_header_above()
```


Data on Canada's annual greenhouse gas emission, annual GHG emission by different economic sectors, and annual GHG emission by different provinces are obtained from the Government of Canada website (@9). Below is a table describing the data about GHG emission levels in different Canada provinces and territories that we collected from Government of Canada after cleaning.

| Variable | Description                          |
|----------|--------------------------------------|
| Year | 3 specified years: 1990, 2005, 2020                 |
| Province pr Territory     | All the Canadian provinces and territories (ON, BC, etc.)              |
| GHG Emission        | the greenhouse gas emissions in megatons of CO$_2$ equivalent    |

Below is a table describing the data about GHG emission levels in different Canadian economic sectors that we collected from Government of Canada after cleaning.

| Variable | Description                          |
|----------|--------------------------------------|
| Year | 3 specified years: 1990, 2005, 2020                 |
| Total     | The total GHG emissions in the specified year, in Mt CO$_2$ eq             |
| Sector       | Economic sectors (oil and gas, transports, buildings, electricity, heavy industry, agriculture, waste and others)   |
| GHG Emission        | the greenhouse gas emissions in Mt CO$_2$ eq     |

Canada's GDP per capita (@10) and population (@11) is obtained from the World Bank national accounts data, and OECD National Accounts data files. (CITATION)

Data on Canada's GDP by expenditure is obtained from Statistics Canada. (CITATION)


# Results

## Annual Greenhouse Gas Emission, by Country

```{r, echo=FALSE, fig.height=4,fig.width=7, fig.cap="Canada's GHG emissions, GDP, and population"}
country <- Country_Emissions %>%
  filter(Year>=1990) %>%
  ggplot(aes(x = Year, y = `GHG Emission`, group = country, color=country)) + 
  geom_line()+
  labs(title = "GHG Emission (Mt), by country", y='GHG Emission (Mt)',x='Year')+
  theme_minimal()

country
```

We want to get a sense of the greenhouse gas emission situation at a global sense, so it helps to figure out which countries are currently producing the most amount of greenhouse gases. From figure 1, we observed that before 2005, USA was producing the most of the greenhouse gases in the world. China's greenhouse gas emission amount drastically increase in the early 2000's and quickly exceeded the US in 2005 and became the country that emits the most greenhouse gases annually. As of 2020, China emits almost twice as much GHG as the US. Moreover, we have observe a trend in decreasing GHG emissions for the US since 2005, and that the GHG emission from China shows no sign of slowing down. This is expected as China is one of the largest production countries that are producing goods that are send off to the rest of the world. The United States, however, although they possess most of the leading commercial and technological companies, are producing less GHG. This is because the US are setting their production plants in other countries like China and India, which not only shifts GHG emissions out of the US, but firms can also take the advantage of cheaper labor and resource costs.

## Canada's Greenhouse Gas Emission and Economic Indicators
```{r , echo=FALSE, fig.height=3,fig.width=7, fig.cap="Canada's GHG emissions, GDP, and population"}
gdp_cap <- canada_data %>%
  filter(Year >= 1990) %>%
  ggplot(aes(x=Year)) +
  labs(title = "A: Canada GDP per capita ($US)", x="Year", y="GDP per capita ($US)")+
  geom_line(aes(y=`GDP per Capita`), color="blue") +
  geom_point(aes(y=`GDP per Capita`), color="blue") +
  theme_minimal()

population <- canada_data %>%
  filter(Year >= 1990) %>%
  ggplot(aes(x=Year, y=pop)) +
  labs(title = "B: Canada Population, by year", x="Year", y="Population")+
  geom_point(color="red") +
  geom_line(color="red")+
  theme_minimal()

ghg_output <- canada_data %>%
  filter(Year >= 1990) %>%
  ggplot(aes(x=Year, y=`Total greenhouse gas emissions (megatonnes of carbon dioxide equivalent)`)) + 
  labs(title = "C: GHG emissions (Megatons)", x="Year", y="GHG emissions (Mt)")+
  geom_point() +
  geom_line()+
  theme_minimal()

gdp <- canada_data %>%
  filter(Year >= 1990) %>%
  ggplot(aes(x=Year)) +
  labs(title = "D: GDP at market prices ($US)", x="Year", y="GDP ($US)")+
  geom_line(aes(y=`Gross domestic product at market prices`), color="green") +
  geom_point(aes(y=`Gross domestic product at market prices`), color="green") +
  theme_minimal()

figure1 <- ggarrange(gdp_cap, population, ghg_output, gdp,
                    ncol = 2, nrow = 2)

figure1
```

This is an overview on the current situation of Canada's greenhouse gas emissions in relation to its population and GDP. From figure 2D we can see that the Canadian economy has been growing consistently in the past few year. However, it is hard to say that it is going to continute to grow in the upcoming years. See can see that there is a significant decrease in GDP from 2019 to 2020, and this is the result of the COVID-19 pandemic in which many businesses were forced to shut down due to the quarantine policy imposed to combat the virus. As the situation continued to escalate throughout 2020 and 2021, although we do not have access to specific numbers, we are expecting the GDP to continue to decrease, and thus production will decrease further. This recession may not be good for the economy from an economic point of view, but it surely is contributing in mitigating climate change in the form of reducing greenhouse gas emissions. 

From figure 2A and 2C, we can see that Canada's greenhouse gas emissions follows largely a similar pattern with the GDP per capita. When the economy is doing well, there will be lots of production occurring to match up with the large demand on the market, and the increasing production will lead to production plants and business building emitting more greenhouse gases. Also, when the economy is doing well, there will be a lot more demand for transportation and that will increase the amount of fossil emissions to the atmosphere. A similar argument can be made for when the economy is in a recession. 

Figure 2B presents Canada's population. Just as population of a country is tightly connected to its economy, it also has a significant effect on the greenhouse gas emissions of a country. More people means more demand and consumption for goods and services. As the population of Canada continues to grow, we would expect fresh blood to be injected into the country, which would help with the long term growth of the economy. But as we have mentioned before, there will be a trade off between the well-being of the economy and the greenhouse gas emissions in the country. We need to seek for a way that promots economical growth, all while preserving or reducing greenhouse gas emissions. 


```{r, echo=FALSE, fig.height=3,fig.width=7, fig.cap="Canada's GHG emissions, GDP, and population"}
# canada's ghg emission by different sectors
sector_ghg_emissions %>% 
  filter(!is.na(`Megatonnes of carbon dioxide equivalent`)) %>% 
  ggplot() + 
  geom_bar(aes(x= Year, y = Total, fill = sector), stat="identity") + 
  labs(title = "Canada's GHG emission (Mt), by different sectors", y='GHG Emission (Mt)',x='Year') +
  theme_classic()
```

Understanding which economic sectors are producing the most amount of greenhouse gases are crucial for policy makers when they are taking actions against climate change and mitigating greenhouse gas emissions. From 1990 to 2020, we have observed the largest increase in GHG emissions were from the oil and gas sector, which increase from 102.6 Mt CO$_2$ eq in in 1990 to 178.8 Mt CO$_2$ eq in 2020. The second largest increase were from the transportation sector which increased from 120.5 Mt CO$_2$ eq in 1990, to 159.2 Mt CO$_2$ eq in 2020. These increases accompanies the growth of the economy and is for the most part inevitable.

However, there is an offset effect in the electricity and heavy industry sectors. Greenhouse gas emissions in the electricity sector decrease from 94.7 Mt CO$_2$ eq in 2019 to 56.2 Mt CO$_2$ eq in 2020, while emission in heavy industry decrease from 97.2 Mt CO$_2$ eq to 71.8 Mt CO$_2$ eq. Comparing the emission level of 2020 to 2005, we can see that of the overall 69 Mt CO$_2$ eq decrease in GHG emission, most of it comes from the electricity sector which accounts for 61 Mt CO$_2$ eq GHG emission reduction. 


```{r, echo=FALSE, fig.height=3,fig.width=7, warning=FALSE, fig.cap="Canada's GHG emissions, GDP, and population"}
prov_ghg_emissions %>% 
  ggplot(aes(x=`Province or territory`, y=`GHG Emission`, fill=Year)) +
  geom_bar(stat='identity', position='dodge') +
  labs(title = "Canada's GHG emission (Mt), by provinces", y='GHG Emission (Mt)',x='Year') +
  theme_classic()

```

This figure shows that Alberta is producing the most amount of greenhouse gases, followed by Ontario, Quebec, and Saskatchewan. Emissions in most provinces are below the 2005 emission level with the exception of Alberta. In 1990, Ontario was emitting the most amount of GHG due to its large scale manufacturing industries. However, Alberta quickly surpassed Ontario to be the province that emits the most GHG due to its uprising activities in the oil and gas industry. According to the Government of Canada, the decrease of GHG emission in Ontario was driven by the shut down of coal-fired electricity generation plants. Quebec's decrease was the result of decrease in the residential and heavy metal industry. Saskatchewan's decrease was due to the emission reduction in the oil and gas industry. (CITATION)

The Government of Canada also provided an insight of the greenhouse gas emission levels during the first year into the pandemic and stated that all provinces and territories experienced a 5% to 16% decrease.


## Model
```{r, echo=FALSE, include=FALSE}
mod <- lm(`Total greenhouse gas emissions (megatonnes of carbon dioxide equivalent)` ~ Year + `Final consumption expenditure` + 
            `Household final consumption expenditure` + `Goods` + `Durable goods` + `Semi-durable goods` + `Non-durable goods` + `Services` + `Non-profit institutions serving households' final consumption expenditure` +
            `General governments final consumption expenditure` + `Gross fixed capital formation` + `Business gross fixed capital formation` + `Residential structures` + 
            `Non-residential structures, machinery and equipment` + `Non-residential structures` + `Machinery and equipment` + `Intellectual property products` + 
            `Non-profit institutions serving households' gross fixed capital formation` + `General governments gross fixed capital formation` + `Investment in inventories` + 
            `Of which: business investment in inventories` + `Non-farm` + `Farm` + `Exports to other countries` + `Imports from other countries`, data = canada_data)
summary(mod)

mod1 <- lm(`Total greenhouse gas emissions (megatonnes of carbon dioxide equivalent)` ~ `Final consumption expenditure` + 
            `Gross fixed capital formation` + `Investment in inventories` + 
            `Exports to other countries` + Year, data = canada_data)
summary(mod1)

mod2 <- lm(`Total greenhouse gas emissions (megatonnes of carbon dioxide equivalent)` ~ Year + `Gross fixed capital formation` + `Business gross fixed capital formation` + `Residential structures` + 
            `Non-residential structures, machinery and equipment` + `Non-residential structures` + `Machinery and equipment` + `Intellectual property products` + 
            `Non-profit institutions serving households' gross fixed capital formation` + `General governments gross fixed capital formation` + `Exports to other countries`, data = canada_data)
summary(mod2)

mod3 <- lm(`Total greenhouse gas emissions (megatonnes of carbon dioxide equivalent)` ~ Year + `Gross fixed capital formation` + `Business gross fixed capital formation` + `Residential structures` + 
            `Non-residential structures, machinery and equipment` + `Intellectual property products` + 
            `Non-profit institutions serving households' gross fixed capital formation` + `General governments gross fixed capital formation` + `Exports to other countries`, data = canada_data)
summary(mod3)


library(MASS)
stepaic_result <- stepAIC(mod2, direction="both")
stepaic_result

final_model <- lm(`Total greenhouse gas emissions (megatonnes of carbon dioxide equivalent)` ~ Year + `Gross fixed capital formation` + 
                    `Business gross fixed capital formation` + `Machinery and equipment` + `Exports to other countries`, data = canada_data)
summary(final_model)
lmtest::lrtest(mod2, final_model)
coef(final_model)
```

We are going to fit a multiple linear regression model to further analyze the topic of interest: what components of economical activities are the factors that are driving greenhouse gas emissions.
$$ Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_i X_i + \epsilon$$
Where Y is the response variable we are interested in predicting, $X_i$ is the predictors that are used to predict the response variable Y. $\beta_0$ is the y intercept, if there are categorical variables as the predictor, then $\beta_0$ represent the value for a particular reference group, otherwise, $\beta_0$ represents the y intercept where all predictors $X_i$ are equal to 0. For the first model, we fit Canada's annual greenhouse gas emissions as the response variable, and then fit the 4 major GDP categories as the predictor, including final consumer expenditure, gross fixed capital formation (GFCF or investment), investments in inventories, and exports to other counties and we included year as a reference to time. Here we are excluding imports from other counties because these good and services were produced outside of Canada, so it does not possess a significant portion of the total greenhouse gas emissions. 

The summary of the linear model shows that GFCF (investment) and exports have strong statistical significance with a p-value <0.001. P-value is a test statistic that represent the probability of this data set occurring, while assuming the correctness of the null hypothesis. For the linear regression model, the null hypothesis is that $\beta_i = 0$. Since we have obtained a very small p-value for all predictors, we concluding that we have strong evidence against the null hypothesis that $\beta_i = 0$ and there is a relationship between the predictor varibale and the response variable. This make sense because the money invested by companies directed impact the goods and services they produce, without technologies innovation, increasing output will likely increase the greenhouse gas emission from buildings and factories. Exports are contributing positively to greenhouse gas emission due to a similar reason.

Furthermore, we understand that not all investments go into producing products and greenhouse gases, so we fitted a new model with GFCF split into sub-categories of investment such as, business GFCF, residential structures, non-residential structure, machinery and equipment, intellectual property products, non-profit institutions serving households' GFCF, general governments GFCF, along with year and exports. Then we run bi-directional step-wise AIC on the model to reduce the model to obtain the final model below. AIC stands for Akaike Information Criterion, which is a mathematical expression that describes how well the model fits a particular data set, and is used to compare the goodness of fit between different models. Bi-directional step-wise AIC begins with the full model with all the possible predictors, then it is going to remove or add a predictor recursively until we have obtain the model with the smallest AIC value.
$$ Total \text{ } GHG \text{ } emissions = 11390.74 - 5.51(Year) + 8.26\times10^{-4}(GFCF) + 9.26 \times 10^{-4} (Business \text{ } GFCF) + $$ $$1.38 \times 10^{-3} (Machinery \text{ } and \text{ } equipment) + 5.20 \times 10^{-4} (Exports)$$

```{r , echo=FALSE, fig.height=3,fig.width=5, fig.cap="Canada's GHG emissions, GDP, and population"}
r <- resid(final_model)

par(mfrow=c(1,2))
plot(canada_data$`Total greenhouse gas emissions (megatonnes of carbon dioxide equivalent)` ~ fitted(final_model), main="Y versus Y-hat", xlab="Y-hat", ylab="Y")
abline(a = 0, b = 1)
lines(lowess(canada_data$`Total greenhouse gas emissions (megatonnes of carbon dioxide equivalent)` ~ fitted(final_model)), lty=2)
qqnorm(r)
qqline(r)
```

```{r, echo=FALSE, fig.height=4,fig.width=5, fig.cap="Canada's GHG emissions, GDP, and population"}
par(mfrow=c(2,3))
plot(r ~ fitted(final_model), main="Fitted vs Residual", xlab="Fitted", ylab="res.")
plot(r ~ canada_data$`Gross fixed capital formation`, main="GFCF vs Residua", xlab="GFCF", ylab="res")
plot(r ~ canada_data$Year, main="Year vs Residual", xlab="Year", ylab="res")
plot(r ~ canada_data$`Business gross fixed capital formation`, main="Busniess GFCF vs Residual", xlab="Business GFCF", ylab="res")
plot(r ~ canada_data$`Machinery and equipment`, main="M & E vs Residual", xlab="Machinery and Equipment", ylab="res")
plot(r ~ canada_data$`Exports to other countries`, main="Exports vs Residual", xlab="Export", ylab="res")

```

Here we will examine whether or not the final model violates any of the assumptions of a linear regression model. A violation would limit our ability to interpret the model. In the Y versus Y-hat plot, Y represent the actual values and Y-hat represent the predicted value. We can see that when plotting them against each other, they follow largely a straight line at the 45 degree angle, suggesting that the relationship is indeed linear. The Normal Q-Q plot is used to verify the normality assumption. We see that the data set deviates towards the tails of the distribution suggesting that it is not a perfectly normal distribution.

We do not observe any patterns in the residual plot and that all points are randomly scattered around the space. This verifies that the model and data is linear, have constant variance, and uncorrelated. Thus, we conclude that the model is a valid model that satisfies the assumptions of the multiple linear regression model. The final model is as follows:

$$ Total \text{ } GHG \text{ } emissions = 11390.74 - 5.51(Year) + 8.26\times10^{-4}(GFCF) + 9.26 \times 10^{-4} (Business \text{ } GFCF) + $$ $$1.38 \times 10^{-3} (Machinery \text{ } and \text{ } equipment) + 5.20 \times 10^{-4} (Exports)$$
$\beta_0$ means that if all other predictors are 0, the total GHG emissions in Canada for year 0 would be 11390.74 megatons, which is meaning less because an year of 0 does not make sense. $\beta_1 = -5.51$ shows that there is a negative relationship between year and GHG emissions, which means that if we keep all else fixed and increase year by 1, we would expect the total greenhouse gas emission for that year to decrease by 5.51 megatons. $\beta_2 = 8.26 \times 10^{-4}$ means that if we keep all else fixed and increase GFCF (investment) by 1, we would expect the total greenhouse gas emission for that year to increase by $8.26 \times 10^{-4}$ megatons. Similarly, 1 unit increase in Business GFCF would increase total GHG emissions by $9.24 \times 10^{-4}$ megatons, 1 unit increase in machinery and equipment would increase GHG emission by $1.38 \times 10^{-3}$ megatons, and lastly, 1 unit increase in exports would increase emission levels by $5.30 \times 10^{-4}$ megatons.

# Discussion
## Canada'g GHG Emission Levels and the Economy

As settled in the Paris Agreement, the target emission by the year of 2030 will be 30% less than the emission level of 2005. The greenhouse gas emission level for 2005 settles ta 741 Megatons of CO$_2$ equivalent (Mt CO$_2$ eq). The emission levels for 2019 is at 738 MT CO$_2$ eq, while the emission level for 2020 is down to 672 Mt CO$_2$ eq. However, the significant decrease in GHG emission between 2019 to 2020 is unlikely to sustain when the pandemic is over and the economy is rebooted. In fact, we would expect a kick back in greenhouse gas emission level that exceed the 2005 levels, as the country strives for recovering from the pandemic.

As of 2020, the GHG emission level are 9.3% lower than that of the 2005 levels, which is still far away from the target of 30%. From figure 3, we discovered that the driving force of the reduction of GHG emission was in the electricity and heavy industry sector of the economy. The major reduction that occurred from 2019 to 2020 was the introduction of the COVID-19 pandemic, which slowed down the industry and the economy, and posted significant reduction in trade and mobility such as travel by air and land. These targets contributed significantly in the reduction of GHG emission as its effects is visible in the transportation sector, where a 14% decrease (185.5 Mt CO$_2$ eq in 2019 to 159.2 Mt CO$_2$ eq in 2020) was observed. Needless to say, the amount of greenhouse gas emission is positively related to the well-being of the economy. When the economy is performing well, we will have increasing demand for goods and services, which would drive up production quantity to meet the demand. The manufacturing plants, office buildings, and power plants all rely on energy inputs such as electricity and natural gas. Increased amount of economic activities would increase the mobility of its participants, resulting in more people traveling around both by air and land. While burning fossil fuel remains to be one of the primary source of energy, and the increased demand during economic boom will most definitely increase the amount of GHG emissions. Does that mean we have to give up the growth of our economy in order to reduce the amount of greenhouse gas emissions? We did made a promise on the Paris Agreement after all.

Due to the effect of the pandemic, the GHG emission levels are 9.3% below the 2005 emission levels. We have seen a significant decrease in the amount of GHG emissions in the electricity and heavy industry sector, and we are seeing little to no decreases in other sectors since 2005, such as oil and gas, transportation, buildings, agriculture, and waste and others. The most direct solution to reducing GHG emission in other sectors is to promote green energy. The Government of Canada have plans to promote the zero-emission vehicles as part of the actions taken against climate change, and already have plans to increase the electric-vehicle rebates. We can expect the GHG emission levels to continue to go down as the pandemic continues in 2021 and onward, but this does not help with a sustainable economic growth. Oil and gas sector and transporation sector will continue to be two of the major economic sectors that contributes the most the GHG emissions, thus, it is crucial to find sustainable and green energy to slow down the growth of the GHG emissions in these two sectors.

## Suggestions for policy makers

From the multiple linear regression model fitted from the previous part, we observed that from the four major components of GDP expenditure: consumption, gross fixed capital formation (GFCF), investment in inventories, and exports (imports are excluded because they are not produced in Canada), GFCF and exports have strong statistical significance when fitted against total greenhouse gas emissions in Canada. And finally, we have determined that money spend on GFCF, business GFCF, machinary and equipments, and exports are the most significant contributing factors to GHG emissions over the years. As we have mentioned before GHG emissions and GDP are positively related, so an increase in spending on any of the components mentioned above would result in the increase in GHG emission. Investments in busniess and product inventories would increase the energy consumed when operating business buildings and manufacturing plants. And money spend on purhcasing more machinery and equipments would also increase the energy consumed. The increase in the amount of exports would also mean that we are producing more goods and services more domestically. These are all the reasons that each factors are positively effecting GHG emission levels individually. We want to try to avoid giving up too much of these market growing opportunities while decreasing GHG emission levels. 

Investments are crucial for economic growth as it can directly influence interests rate, and carelessly imposing monetary policies to the market could result in unexpected behaviors of investors and backfires on the economy and the goal of reducing greenhouse gas emissions. The carbon tax introduced in recent year are a good way to limit GHG emissions to a specified amount, but it could also prevent the potential growth of firms, markets, and the economy. Carbon tax was introduced in 2019 as $20 per ton on carbon dioxide produced, and the Canadian government's plan for was to raise that tax amount by $10 each year. Thus, instead of try to decrease investments to decrease GHG emissions, we should be spending more money on the research and development sectors of the economy. Increase policies that would benefit innovative firms that are actively trying to reduce their GHG outputs or actively switching to greener energy sources. AS we cannot slow down the growth of the economy too much in the effort of trying to reach the goal specified in the Paris Agreement, policy makers should focus of the subsidizing the R&D sectors, especially researchers, firms, universities, and laborories who are focusing on development of renewable energy and products. Accelerate the process which these world changing inventions come to life is better than limiting GHG emissions in the short run, all while holding back the growth of the economy.

## The world

Canada meeting its target is not enough to slow down the current state of global climate change, but it certainly would help. What is important is to find a way to slow down the rate at which China and the US are emitting GHG. The two of them are emitting more GHG each year than the rest of the world combined. But too sudden of an effort in trying to decrease GHG emission would result in economic malfunctions within their countries  and would radiates to the rest of the world, much like how countries are behaving during the COVID-19 pandemic. Similar models and arguments can also be applied to other countries where we can post policeis such as carbon tax and the cap and trade system to limit GHG emissions in the short run to buy them time to develop new and greener sources of energy.

Moreover, the COVID pendamic's contribution to GHG emissions does not limit to less production and traveling, but also the changing life style of individuals and operating strategies of business give us insight to how the future workplace would look like and how it helps to reduce GHG emissions from transportation and busniess buildings. As the pandemic continued on for the past 2 years, individuals and firms have adapted to remote working environments where people can work from home and business buildings are operating at minimal cost. This not only reduces GHG emissions from mandatory transportations as people routeinly travel from home to workplace and then back home, but also reduce the GHG emissions emitted by operating business buildings. Working remotely not only saves the time and resources of traveling, but also allows more flexible schedules that contributes to the well-being of the individuals. When the economy world wide is finally back on track in the future once the pandemic is over, policy maker can try to promote these types of remote working environments among traffic heavy cities, and this would help with reducing GHG emissions by a lot, while buying time for new energy source to be introduced.

## Weaknesses and next steps

Also all data set are obtained from credible authorities, there still may post inaccuracies such as underestimating the total greenhouse gas emission levels because GHG emissions are hard to meaasure and quantify. There are more ways to combat climate change and reduce GHG emissions that are not being mentioned in this report, methods may include plating trees, reduce deforestation, and desertification. Moreover, the amount of GHG emissions reported in 2020 coincide with the first year of the COVID-19 pandemic, which had a significant impact on various aspects of the economy, especially on the transportation and energy sectors. Thus, estimates incluidng 2020 emission levels need to be interpreted with caution as it may not reflect the true trend of GHG emissions. AS the pandemic incoming to an end hopefully in the near future, it is unkown how the reopening is going effect the economy and the greenhouse gas emission level. Thus, the model mat not accurately predict the future behaviour based solely on the data from 1990 to 2020.

For next steps, we would like to have access to the more recent data on GDP and total greenhouse gas emission levels during th pandemic lockdown. That way we will be able to provide more meaningful insight to how the market and GHG emission level is going to behave after the pandemic has passed.

\newpage

\appendix

# Appendix {-}


# Additional details


\newpage


# References


